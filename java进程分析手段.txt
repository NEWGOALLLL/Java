java进程分析每个线程资源占用情况
工具： JVM指令+Process Explorer
1.在任务管理器中找到cpu占用最高的java进程
2.打开process explorer双击目标进程查找该进程的Threads信息。
3.在cmd窗口使用jstack指令把java应用的栈信息dump到本地分析。需注意jstack中的线程id是十六进制的。要把线程的TID信息转换成16进制。如图TID为46280的十六进制是B4C84.使用jstack命令输出dump文件,这里加上的-l,表示仅输出锁信息
4.使用jstack命令输出dump文件,这里加上的-l,表示仅输出锁信息
 jstack -l 进程号 > 文件位置   
5.查找线程b4c8即可找到此线程的业务代码调用位置
6.对比源代码，发现此处是一个监听线程，持续监听外部socket链接。回到任务管理器的进程详情，发现此时java进程占用56%的cpu，其中有5个监听线程平均每个占用3-4%的cpu总共约20%。总共上百个线程，为什么只有这几个线程占用cpu最高？因为这几个线程执行的是上图所示的无限循环监听代码，无限循环会执行完cpu时间片的全部时间后才会强制切换上下文，占用100%时间片。故cpu占用率高。
